var a=class{constructor(){return(async()=>(this.worker=new Worker("./libraw-mini-worker.js",{type:"module"}),this.waitForWorker=!1,this.worker.onmessage=({data:r})=>{if(r?.out?.cb&&this.cb)return this.cb(r.out.count,r.out.msg);if(this.waitForWorker){let{return:e,error:n}=this.waitForWorker;this.waitForWorker=!1,r?.error?n(r.error):e(r?.out)}},await new Promise((r,e)=>{this.waitForWorker={error:e,return:r}}),this))()}async runFn(t,...r){let e=new Promise((n,i)=>{this.waitForWorker={error:i,return:n}});return this.worker.postMessage({fn:t,args:r},r.map(n=>{if([ArrayBuffer,Uint8Array,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array,Float32Array,Float64Array].some(i=>n instanceof i))return n.buffer}).filter(n=>n)),await e}async init(){return await this.runFn("init",null,null)}async open(t,r){return await this.runFn("open",t,r)}async close(){return await this.runFn("close",null,null)}async getimage(t=null){return t&&(this.cb=t),await this.runFn("get_image",null,null)}async getthumbnail(){return await this.runFn("get_thumb",null,null)}async getmetadata(){return await this.runFn("get_metadata",null,null)}async setparams(t){return await this.runFn("set_params",t,null)}async version(){return await this.runFn("version",null,null)}};export{a as LibRaw};
